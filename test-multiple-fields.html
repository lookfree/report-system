<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šå­—æ®µæ··åˆæ–‡æœ¬æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            padding: 20px;
            background: #f0f2f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        h1 {
            color: #1a1a1a;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #667eea;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #e1e8f0;
            border-radius: 6px;
            background: #fafbfc;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f5f5f5;
            font-weight: bold;
            color: #333;
        }

        /* å†…è”æ•°æ®é›†å ä½ç¬¦æ ·å¼ */
        .dataset-placeholder-inline {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 500;
            font-size: 0.9em;
            display: inline-block;
            margin: 0 2px;
            animation: pulse 2s infinite;
        }

        /* å—çº§æ•°æ®é›†å ä½ç¬¦æ ·å¼ */
        .dataset-placeholder {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: 500;
            text-align: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            50% {
                box-shadow: 0 4px 8px rgba(102, 126, 234, 0.4);
            }
            100% {
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
        }

        .info-box {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }

        .success-box {
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }

        .code-example {
            background: #f5f5f5;
            border: 1px solid #d9d9d9;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            overflow-x: auto;
        }

        .test-cell {
            min-height: 60px;
            padding: 15px;
            background: white;
            cursor: pointer;
            transition: background 0.3s;
        }

        .test-cell:hover {
            background: #f0f5ff;
        }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .badge-success {
            background: #52c41a;
            color: white;
        }

        .badge-warning {
            background: #faad14;
            color: white;
        }

        .badge-info {
            background: #1890ff;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ å¤šå­—æ®µæ··åˆæ–‡æœ¬æ’å…¥æµ‹è¯•</h1>

        <div class="info-box">
            <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>
            <p>æ”¯æŒåœ¨å•ä¸ªè¡¨æ ¼å•å…ƒæ ¼ä¸­æ’å…¥å¤šä¸ªç»Ÿè®¡å­—æ®µï¼Œå­—æ®µä¹‹é—´å¯ä»¥æ·»åŠ è¯´æ˜æ–‡å­—ï¼Œå®ç°çµæ´»çš„æ•°æ®å±•ç¤ºã€‚</p>
        </div>

        <div class="test-section">
            <h2>æµ‹è¯•åœºæ™¯ 1ï¼šç»Ÿè®¡æ±‡æ€»ä¿¡æ¯</h2>
            <table>
                <thead>
                    <tr>
                        <th width="30%">ç»Ÿè®¡é¡¹ç›®</th>
                        <th width="70%">ç»Ÿè®¡ç»“æœ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>æ¨¡æ¿æ€»æ•°ç»Ÿè®¡</td>
                        <td class="test-cell">
                            å½“å‰ç³»ç»Ÿå…±æœ‰
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="1"
                                  data-dataset-name="æ¨¡æ¿ç»Ÿè®¡"
                                  data-field-name="total_count"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Štotal_count
                            </span>
                            ä¸ªæ¨¡æ¿ï¼Œå…¶ä¸­æ´»è·ƒæ¨¡æ¿
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="1"
                                  data-dataset-name="æ¨¡æ¿ç»Ÿè®¡"
                                  data-field-name="active_count"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šactive_count
                            </span>
                            ä¸ªï¼Œå æ¯”
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="1"
                                  data-dataset-name="æ¨¡æ¿ç»Ÿè®¡"
                                  data-field-name="active_percentage"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šactive_percentage
                            </span>
                            <span class="badge badge-success">å·²é…ç½®</span>
                        </td>
                    </tr>
                    <tr>
                        <td>ç”¨æˆ·æ´»è·ƒåº¦</td>
                        <td class="test-cell">
                            æœ¬æœˆæ´»è·ƒç”¨æˆ·
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="2"
                                  data-dataset-name="ç”¨æˆ·ç»Ÿè®¡"
                                  data-field-name="monthly_active"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šmonthly_active
                            </span>
                            äººï¼Œæ—¥å‡æ´»è·ƒ
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="2"
                                  data-dataset-name="ç”¨æˆ·ç»Ÿè®¡"
                                  data-field-name="daily_average"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šdaily_average
                            </span>
                            äººï¼Œç¯æ¯”å¢é•¿
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="2"
                                  data-dataset-name="ç”¨æˆ·ç»Ÿè®¡"
                                  data-field-name="growth_rate"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šgrowth_rate
                            </span>
                            %
                            <span class="badge badge-success">å·²é…ç½®</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="test-section">
            <h2>æµ‹è¯•åœºæ™¯ 2ï¼šæŠ¥å‘Šæ‘˜è¦ä¿¡æ¯</h2>
            <table>
                <thead>
                    <tr>
                        <th width="30%">æ‘˜è¦é¡¹</th>
                        <th width="70%">å†…å®¹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>å®¡è®¡æ¦‚å†µ</td>
                        <td class="test-cell">
                            æœ¬æ¬¡å®¡è®¡å…±æ£€æŸ¥äº†
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="total_items"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Štotal_items
                            </span>
                            ä¸ªé¡¹ç›®ï¼Œå‘ç°é«˜é£é™©é—®é¢˜
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="high_risk"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šhigh_risk
                            </span>
                            ä¸ªï¼Œä¸­é£é™©é—®é¢˜
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="medium_risk"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šmedium_risk
                            </span>
                            ä¸ªï¼Œä½é£é™©é—®é¢˜
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="low_risk"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šlow_risk
                            </span>
                            ä¸ªã€‚
                            <span class="badge badge-success">å·²é…ç½®</span>
                        </td>
                    </tr>
                    <tr>
                        <td>æ•´æ”¹æƒ…å†µ</td>
                        <td class="test-cell">
                            æˆªè‡³
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="report_date"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šreport_date
                            </span>
                            ï¼Œå·²å®Œæˆæ•´æ”¹
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="completed_items"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šcompleted_items
                            </span>
                            é¡¹ï¼Œæ•´æ”¹ç‡è¾¾åˆ°
                            <span class="dataset-placeholder-inline"
                                  data-dataset-id="3"
                                  data-dataset-name="å®¡è®¡ç»Ÿè®¡"
                                  data-field-name="completion_rate"
                                  data-data-type="single"
                                  data-display-mode="SINGLE">
                                ğŸ“Šcompletion_rate
                            </span>
                            %
                            <span class="badge badge-success">å·²é…ç½®</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="test-section">
            <h2>æµ‹è¯•åœºæ™¯ 3ï¼šæ··åˆå±•ç¤ºï¼ˆå•æ¡å­—æ®µ + åˆ—è¡¨æ•°æ®ï¼‰</h2>
            <table>
                <thead>
                    <tr>
                        <th>ç±»å‹</th>
                        <th>å±•ç¤ºå†…å®¹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ç»¼åˆæŠ¥å‘Š</td>
                        <td class="test-cell">
                            <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š
                                <span class="dataset-placeholder-inline"
                                      data-dataset-id="4"
                                      data-dataset-name="æŠ¥å‘Šä¿¡æ¯"
                                      data-field-name="generate_time"
                                      data-data-type="single"
                                      data-display-mode="SINGLE">
                                    ğŸ“Šgenerate_time
                                </span>
                                ï¼Œç”Ÿæˆäººï¼š
                                <span class="dataset-placeholder-inline"
                                      data-dataset-id="4"
                                      data-dataset-name="æŠ¥å‘Šä¿¡æ¯"
                                      data-field-name="author"
                                      data-data-type="single"
                                      data-display-mode="SINGLE">
                                    ğŸ“Šauthor
                                </span>
                            </p>
                            <p>è¯¦ç»†æ•°æ®åˆ—è¡¨ï¼š</p>
                            <div class="dataset-placeholder"
                                 data-dataset-id="1"
                                 data-dataset-name="æ¨¡æ¿åˆ—è¡¨"
                                 data-display-fields="id,name,createdAt"
                                 data-data-type="list">
                                ğŸ“Š æ¨¡æ¿åˆ—è¡¨<br/>
                                <small style="opacity: 0.9;">è¡¨æ ¼æ•°æ®</small>
                            </div>
                            <span class="badge badge-info">æ··åˆæ¨¡å¼</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="success-box">
            <h3>âœ… å®ç°æ•ˆæœ</h3>
            <ul>
                <li>æ”¯æŒåœ¨å•ä¸ªå•å…ƒæ ¼ä¸­æ’å…¥å¤šä¸ªæ•°æ®é›†å­—æ®µ</li>
                <li>å­—æ®µä¹‹é—´å¯ä»¥æ·»åŠ ä»»æ„è¯´æ˜æ–‡å­—</li>
                <li>å†…è”æ˜¾ç¤ºæ–¹å¼ï¼Œä¸æ–‡æœ¬è‡ªç„¶èåˆ</li>
                <li>ç´«è‰²æ¸å˜èƒŒæ™¯æ ‡è¯†ï¼Œå¸¦å‘¼å¸åŠ¨ç”»æ•ˆæœ</li>
                <li>é¢„è§ˆæ—¶è‡ªåŠ¨æ›¿æ¢ä¸ºå®é™…æ•°æ®å€¼</li>
                <li>æ”¯æŒå•æ¡æ•°æ®å’Œåˆ—è¡¨æ•°æ®æ··åˆå±•ç¤º</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>ä½¿ç”¨è¯´æ˜</h2>
            <ol>
                <li><strong>æ’å…¥å­—æ®µï¼š</strong>åŒå‡»è¡¨æ ¼å•å…ƒæ ¼ï¼Œé€‰æ‹©"å•æ¡"æ¨¡å¼ï¼Œé€‰æ‹©è¦æ’å…¥çš„å­—æ®µ</li>
                <li><strong>æ·»åŠ æ–‡å­—ï¼š</strong>åœ¨å­—æ®µå ä½ç¬¦ä¹‹é—´ç›´æ¥è¾“å…¥è¯´æ˜æ–‡å­—</li>
                <li><strong>ç»§ç»­æ’å…¥ï¼š</strong>å°†å…‰æ ‡æ”¾åœ¨éœ€è¦çš„ä½ç½®ï¼Œå†æ¬¡åŒå‡»æ’å…¥æ–°å­—æ®µ</li>
                <li><strong>é¢„è§ˆæ•ˆæœï¼š</strong>ç‚¹å‡»é¢„è§ˆæŒ‰é’®æŸ¥çœ‹å®é™…æ•°æ®æ›¿æ¢æ•ˆæœ</li>
            </ol>

            <div class="code-example">
                // åç«¯å¤„ç†é€»è¾‘<br>
                async processInlineDatasetPlaceholders(html, context) {<br>
                &nbsp;&nbsp;// åŒ¹é…æ‰€æœ‰å†…è”å ä½ç¬¦<br>
                &nbsp;&nbsp;const inlineRegex = /&lt;span[^&gt;]*class="dataset-placeholder-inline"[^&gt;]*&gt;[\s\S]*?&lt;/span&gt;/g;<br>
                &nbsp;&nbsp;// æŒ‰æ•°æ®é›†IDåˆ†ç»„ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢<br>
                &nbsp;&nbsp;// æ‰¹é‡æ›¿æ¢ä¸ºå®é™…æ•°æ®<br>
                }
            </div>
        </div>

        <div class="test-section">
            <h2>ç©ºå•å…ƒæ ¼æµ‹è¯•</h2>
            <table>
                <thead>
                    <tr>
                        <th>å¾…é…ç½®é¡¹</th>
                        <th>æ“ä½œè¯´æ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ç©ºå•å…ƒæ ¼</td>
                        <td class="test-cell" contenteditable="true" style="min-height: 80px;">
                            åŒå‡»æ­¤å•å…ƒæ ¼å¯ä»¥æ’å…¥æ•°æ®é›†å­—æ®µï¼Œè¾“å…¥æ–‡å­—åå†æ¬¡åŒå‡»å¯åœ¨å…‰æ ‡å¤„ç»§ç»­æ’å…¥...
                            <span class="badge badge-warning">å¾…é…ç½®</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>